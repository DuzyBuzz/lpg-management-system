<div class="space-y-6">
  <!-- Header -->
  <div class="bg-gradient-to-r from-slate-900 to-slate-800 rounded-lg p-6 text-white">
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
      <div>
        <h1 class="text-2xl sm:text-3xl font-bold">LPG Distribution Dashboard</h1>
        <p class="text-slate-300 mt-2 text-sm sm:text-base">
          Branch Performance & Driver Analytics — January 2026
        </p>
        <p class="text-slate-400 mt-1 text-xs">
          Monthly report for <span class="font-semibold">{{ snapshotPeriod }}</span>
        </p>
      </div>
      <div class="text-right">
        <p class="text-sm text-slate-300">Reporting Period</p>
        <p class="text-lg font-semibold text-yellow-300">
          {{ snapshotPeriod }}
        </p>
      </div>
    </div>
  </div>
  <div>
    <button>
      Branch Sales
    </button>
        <button>
      Driver Sales
    </button>
        <button>
      Volume Sales
    </button>
  </div>

  <!-- Business Metrics Cards -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 gap-4">
    <div *ngFor="let metric of branchMetrics" class="bg-white rounded-lg p-6 shadow-sm hover:shadow-md transition-shadow">
      <div class="flex justify-between items-start mb-4">
        <div class="text-3xl">{{ metric.icon }}</div>
        <span class="text-green-500 text-sm font-semibold">
          {{ metric.change }}
        </span>
      </div>
      <p class="text-slate-600 text-sm mb-2">{{ metric.label }}</p>
      <p class="text-2xl font-bold text-slate-900">{{ metric.value }}</p>
    </div>
  </div>

  <!-- Charts Grid (MONTH-SPECIFIC ONLY) -->
  <div class="grid grid-cols-1 md:grid-cols-1 gap-6">
<!-- Daily Cash Sales — Line Chart -->
<div class="bg-white rounded-lg p-6 shadow-sm">
  <h2 class="text-xl font-bold text-slate-900 mb-2">Daily Cash Sales — January 2026</h2>
  <p class="text-xs text-slate-500 mb-2">Daily LPG sales performance (Jan 1–31, 2026)</p>

  <!-- Branch Filter (Buttons) -->
  <div class="flex flex-wrap gap-2 mb-4 justify-start">
    <button
      *ngFor="let branch of branches"
      type="button"
      (click)="onBranchChange(branch)"
      class="px-4 py-2 rounded-md text-sm font-semibold transition-all"
      [ngClass]=" selectedBranch === branch ? 'bg-blue-600 text-white shadow' : 'bg-slate-100 text-slate-700 hover:bg-slate-200' ">
      {{ branch }}
    </button>
  </div>

  <!-- Chart -->
  <div class="w-full h-96 mb-6">
  <canvas
    baseChart
    [data]="dailySalesChartData"
    [options]="dailySalesChartOptions"
    [type]="dailyChartType">
  </canvas>
  </div>

  <!-- List (below chart) -->
  <div class="space-y-2 h-96 overflow-auto px-2">
    <div *ngFor="let item of dailySalesFluctuation" class="space-y-1">
      <div class="flex justify-between items-center text-sm">
        <span class="text-slate-600 font-medium">{{ item.day }} — {{ item.branch }}</span>
        <div class="flex items-center gap-2">
          <span class="text-slate-900 font-bold">₱{{ item.sales | number:'1.0-0' }}</span>
          <span class="text-sm font-semibold" [ngClass]="item.trend === 'up' ? 'text-green-600' : 'text-red-600'">
            {{ item.trend === 'up' ? '▲' : '▼' }}
          </span>
        </div>
      </div>
    </div>

    <div *ngIf="dailySalesFluctuation.length === 0" class="text-center text-slate-500 text-sm py-6">
      No sales data for selected branch.
    </div>
  </div>
</div>

  </div>

  <!-- Branch Sales Distribution -->
  <div class="bg-white rounded-lg p-6 shadow-sm">
    <h2 class="text-xl font-bold text-slate-900 mb-6">Cash Sales Distribution by Branch — January 2026</h2>

    <div class="flex items-center justify-center mb-8">
      <svg viewBox="0 0 200 200" class="w-96 h-96" role="img" aria-label="Branch distribution pie">
        <g *ngFor="let item of branchDistributionData; let i = index">
          <path
            [attr.d]="getPieSlice(item.percentage, getBranchAngle(i))"
            [attr.fill]="item.color"
            opacity="0.9"
          ></path>
        </g>
      </svg>
    </div>

    <div class="space-y-3">
      <div *ngFor="let item of branchDistributionData" class="flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="w-3 h-3 rounded-full" [style.backgroundColor]="item.color"></div>
          <span class="text-slate-700 font-medium">{{ item.branch }}</span>
        </div>
        <div class="text-right">
          <span class="text-slate-900 font-bold">{{ item.sales }}</span>
          <span class="text-slate-500 text-sm ml-2">({{ item.percentage }}%)</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Branch Performance Table -->
  <div class="bg-white rounded-lg p-4 sm:p-6 shadow-sm">
    <h2 class="text-xl font-bold text-slate-900 mb-6">Branch Performance Overview — {{ snapshotPeriod }}</h2>

    <div class="overflow-x-auto">
      <table class="w-full text-sm">
        <thead>
          <tr class="border-b-2 border-slate-200">
            <th class="text-left py-2 px-4">Branch</th>
            <th class="text-left py-2 px-4">Cash Sales</th>
            <th class="text-left py-2 px-4">Volume (Tons)</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let branch of branchPerformanceData" class="border-b border-slate-100 hover:bg-slate-50">
            <td class="py-2 px-4 font-medium">{{ branch.branch }}</td>
            <td class="py-2 px-4 font-bold">{{ branch.cashSales }}</td>
            <td class="py-2 px-4">
              <div class="flex items-center gap-2">
                <div class="w-20 bg-slate-200 rounded-full h-2">
                  <div class="bg-blue-500 h-2 rounded-full" [style.width.%]="(branch.volumeConsumption / 68) * 100"></div>
                </div>
                <span class="font-semibold">{{ branch.volumeConsumption }}</span>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Unattached Drivers (January 2026) -->
  <div class="bg-white rounded-lg p-4 sm:p-6 shadow-sm">
    <div class="flex items-center gap-3 mb-6">
      <h2 class="text-xl font-bold text-slate-900"> Drivers — January 2026</h2>
    </div>

    <table class="w-full text-sm">
      <thead>
        <tr class="border-b-2">
          <th class="text-left py-2 px-4">Driver ID</th>
          <th class="text-left py-2 px-4">Name</th>
          <th class="text-left py-2 px-4">Cash Sales</th>
          <th class="text-left py-2 px-4">Volume</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let d of unattachedDrivers" class="border-b hover:bg-slate-50">
          <td class="py-2 px-4">{{ d.driverId }}</td>
          <td class="py-2 px-4">{{ d.name }}</td>
          <td class="py-2 px-4 font-bold">{{ d.cashSales }}</td>
          <td class="py-2 px-4">{{ d.volumeTons }} tons</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
